<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mini Profile + Photo Uploader</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    .card { border: 1px solid #ccc; padding: 20px; max-width: 500px; }
    label { display: block; margin-top: 10px; }
    button { margin-top: 15px; }
  </style>
</head>
<body>

  <h1>Mini Profile + Photo Uploader</h1>
  <p>
    This demo saves profile data to <b>Cosmos DB</b> and images to
    <b>Blob Storage</b>.
  </p>

  <div class="card">
    <h2>Create Profile</h2>

    <form id="profileForm">
      <label>Name</label>
      <input type="text" id="name" required />

      <label>Age</label>
      <input type="number" id="age" required />

      <label>Bio</label>
      <textarea id="bio" required></textarea>

      <label>Profile Picture</label>
      <input type="file" id="photo" accept="image/*" required />
      <small>Choose a small image for faster upload.</small>

      <button type="submit">Create</button>
    </form>

    <div id="result" style="display:none;"></div>
  </div>

  <script>
    const form = document.getElementById("profileForm");
    const result = document.getElementById("result");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      // 1) Upload image to Blob
      const photo = document.getElementById("photo").files[0];
      const uploadData = new FormData();
      uploadData.append("photo", photo);

      const uploadRes = await fetch("/api/upload", {
        method: "POST",
        body: uploadData
      });

      const uploadJson = await uploadRes.json();
      const imageUrl = uploadJson.imageUrl;

      // 2) Create profile in Cosmos
      const profile = {
        name: document.getElementById("name").value,
        age: document.getElementById("age").value,
        bio: document.getElementById("bio").value,
        imageUrl
      };

      const profileRes = await fetch("/api/profiles", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(profile)
      });

      const profileJson = await profileRes.json();

      // 3) Show result
      result.style.display = "block";
      result.innerHTML = `
        <p><b>Profile created!</b></p>
        <p><a href="/profile/${profileJson.id}">View Profile</a></p>
      `;
    });
  </script>

</body>
</html>

<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>

    <h1>Mini Profile + Photo Uploader</h1>
    <p>
      This demo saves profile data to <b>Cosmos DB</b> and images to
      <b>Blob Storage</b>.
    </p>

    <div class="card">
      <h2>Create Profile</h2>

      
        <label>Name</label>
        

        <label>Age</label>
        

        <label>Bio</label>
        

        <label>Profile Picture</label>
        
        <small>Choose a small image for faster upload.</small>

        Create
      

      <div class="card" style="display: none;"></div>
    </div>

    
  

<script type="module" src="https://s.brightspace.com/lib/bsi/2026.2.264/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					if (document.querySelector('math, .d2l-element, .d2l-cplus-layout') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
						document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
							elm.setAttribute('style', 'display: block; height: 0.5rem;');
						});

						document.querySelectorAll('math mmultiscripts > none').forEach(elm => {
							const mrow = document.createElementNS('http://www.w3.org/1998/Math/MathML', 'mrow');
							elm.replaceWith(mrow);
						});

						window.D2L.MathJax.loadMathJax({
							outputScale: 1.5,
							renderLatex: false,
							enableMML3Support: false
						});
					}
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/2026.2.264/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/2026.2.264/unbundled/embeds.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					window.D2L.EmbedRenderer.renderEmbeds(document.body);
				});</script></body></html> -->